---
title: "sptotal Package"
author:
  - Matthew Higham, Jay M.Ver Hoef, Bryce M. Frank, Francisco M. Gutierrez 
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, echo = FALSE, message = FALSE}
########################################################################
########################################################################
########################################################################
#        Notation
########################################################################
########################################################################
########################################################################
```

# Introduction


Monitoring ecological populations is an important goal for both academic research and management of natural resources. Estimation methods that depend on design-based probability are very robust. Very few assumptions are required because the distribution for inference comes from the sample design, which is known and under our control. In this package we will be interested in estimating (predicting) a mean or total from a finite number of sample units in a fixed geographic area. For design-based methods, sample plots are chosen at random, they are counted, and inference is obtained from the probability of sampling units randomly (e.g., Horwitz-Thompson estimation). For moose surveys there are a finite number of sample units and so finite population methods are used.

There are some problems with design-based methods. Because few assumptions are required, they may lack power in cases where further assumptions are justified. This appears to be especially true in the case of ''small area'' estimation. The term small area estimation refers to making an inference on a smaller geographic area within the overall study area. There may be few or no samples within that small area, so that estimation may not be possible or variances become exceedingly large. An alternative is to assume that the data were generated by a stochastic process and use model-based approaches (see, e.g., Fay and Harriot 1979, Ghosh and Meeden 1986, and Prasad and Rao 1990). 

In the sptotal package, the basic problem is that we want to estimate some linear function of all of the sample units, call it $\tau(\mathbf{z})$, where $\mathbf{z}$ is a vector of the realized values for all the sample units. The function $\tau(\mathbf{z})$ could be the population mean, population total, or the mean or total of a subset of sample units that have few or no observed samples. The goal is to use a predictor based on the set of observed samples $\widehat{\tau}(\mathbf{z}_{s})$, where $\mathbf{z}_{s}$ is a vector of observed values for sampled units (see e.g., Bolfarine and Zacks 1992, pg. 6). It is assumed that $\mathbf{z}$ is a realization of a spatial stochastic process. Geostatistical models and methods are used (for a review, see Cressie, 1993). Geostatistics has been developed for point samples. If the samples are very small, an infinite population is assumed. The average value over any aggregated area can be predicted using methods such as block kriging. Thus it appears that this is closely related to small area estimation, but where samples come from point locations rather than a finite set of sample units. While there is a large literature on geostatistics and block kriging methods, they have been developed for infinite populations. This package is designed for the case where we have a finite collection of plots and we assume that the data were produced by a spatial stochastic process. Detailed developements are given in Ver Hoef (2008), and we give an overview here.

## Vignette Info

Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette.

## Styles

The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:

    output: 
      rmarkdown::html_vignette:
        css: mystyles.css

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
